{"version":3,"sources":["lib/geo.js","components/UpdateForm.jsx","lib/data.js","components/StationRow.jsx","components/StationList.jsx","App.js","index.js"],"names":["haversineDistance","lon1","lat1","lon2","lat2","isMiles","toRadian","angle","Math","PI","distance","a","b","dLat","dLon","pow","sin","cos","c","asin","sqrt","finalDistance","findNearestStations","lonlat","stations","maxDistance","filter","station","coords","sort","s1","s2","UpdateForm","props","stationId","useState","undefined","petrol","setPetrol","diesel","setDiesel","queue","setQueue","msg","setMsg","className","Row","Col","Alert","variant","Form","onSubmit","e","preventDefault","console","log","data","callback","axios","post","process","then","saveStation","id","Group","as","controlId","Label","column","sm","Check","inline","label","name","type","checked","onChange","value","Range","min","max","step","event","target","Button","getFuelConfidenceScore","mRecent","mAll","mRecent_total","yes","no","mAll_total","mRecent_strength","mAll_strength","getLabelForConfidence","confidence","abs","StationRow","last_update","phone","address","stats","isFormVisible","setFormVisible","userLocation","myGmapsLocation","mapUrl","dieselConfidence","dieselLabel","dieselVariant","petrolConfidence","petrolLabel","petrolVariant","lastUpdate","round","Date","getTime","ceil","href","Badge","bg","size","onClick","StationList","updateMinutesAgo","stationElemennts","map","App","setStations","nearestStations","setNearestStations","loadError","setLoadError","position","setPosition","error","setError","latitude","longitude","onError","message","useEffect","geo","navigator","geolocation","watcher","watchPosition","clearWatch","usePosition","errorCallback","url","get","catch","loadStations","result","stationData","station_data","content","Container","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.59b253f5.chunk.js","sourcesContent":["import { useState, useEffect } from \"react\";\n\nconst RADIUS_OF_EARTH_IN_KM = 6371;\n// const X_RANGE = 0.2;\n// const y_RANGE = 0.2;\n\n/**\n * Calculates the haversine distance between point A, and B.\n * @param {number[]} latlngA [lng, lat] point A\n * @param {number[]} latlngB [lng, lat] point B\n * @param {boolean} isMiles If we are using miles, else km.\n */\nconst haversineDistance = ([lon1, lat1], [lon2, lat2], isMiles = true) => {\n  const toRadian = (angle) => (Math.PI / 180) * angle;\n  const distance = (a, b) => (Math.PI / 180) * (a - b);\n\n  const dLat = distance(lat2, lat1);\n  const dLon = distance(lon2, lon1);\n\n  lat1 = toRadian(lat1);\n  lat2 = toRadian(lat2);\n\n  // Haversine Formula\n  const a =\n    Math.pow(Math.sin(dLat / 2), 2) +\n    Math.pow(Math.sin(dLon / 2), 2) * Math.cos(lat1) * Math.cos(lat2);\n  const c = 2 * Math.asin(Math.sqrt(a));\n\n  let finalDistance = RADIUS_OF_EARTH_IN_KM * c;\n\n  if (isMiles) {\n    finalDistance /= 1.60934;\n  }\n\n  return finalDistance;\n};\n\nconst findNearestStations = (lonlat, stations, maxDistance) => {\n  const out = stations.filter(\n    (station) => haversineDistance(lonlat, station.coords) < maxDistance\n  );\n\n  return out.sort(\n    (s1, s2) =>\n      haversineDistance(lonlat, s1.coords) -\n      haversineDistance(lonlat, s2.coords)\n  );\n};\n\nexport const usePosition = () => {\n  const [position, setPosition] = useState({});\n  const [error, setError] = useState(null);\n\n  const onChange = ({ coords }) => {\n    setPosition({\n      latitude: coords.latitude,\n      longitude: coords.longitude,\n    });\n  };\n  const onError = (error) => {\n    setError(error.message);\n  };\n  useEffect(() => {\n    const geo = navigator.geolocation;\n    if (!geo) {\n      setError(\"Geolocation is not supported\");\n      return;\n    }\n    const watcher = geo.watchPosition(onChange, onError);\n    return () => geo.clearWatch(watcher);\n  }, []);\n  return { ...position, error };\n};\n\nexport { haversineDistance, findNearestStations };\n","import { useState } from \"react\";\nimport { Row, Form, Col, Alert, Button } from \"react-bootstrap\";\nimport { saveStation } from \"../lib/data\";\nconst UpdateForm = (props) => {\n  const { stationId } = props;\n  const [petrol, setPetrol] = useState(undefined);\n  const [diesel, setDiesel] = useState(undefined);\n  const [queue, setQueue] = useState(-5);\n  const [msg, setMsg] = useState(null);\n  if (msg) {\n    return (\n      <div className=\"submitForm\">\n        <Row>\n          <Col>\n            <Alert variant=\"success\">\n              Thank you for submitting this information. It will appear on the\n              website within the next 10-15 minutes.\n            </Alert>\n          </Col>\n        </Row>\n      </div>\n    );\n  }\n  return (\n    <div className=\"submitForm\">\n      <Form\n        onSubmit={(e) => {\n          e.preventDefault();\n          console.log(e);\n          const data = {\n            id: stationId,\n            petrol,\n            diesel,\n            queue,\n          };\n          saveStation(data, () => {\n            setMsg(true);\n          });\n        }}\n      >\n        <Form.Group as={Row} className=\"mb-3\" controlId=\"formPetrol\">\n          <Form.Label column sm=\"4\">\n            Is there Petrol?\n          </Form.Label>\n          <Col sm=\"8\">\n            <Form.Check\n              inline\n              label=\"Yes\"\n              name=\"petrol\"\n              type=\"radio\"\n              id=\"petrol-check-yes\"\n              checked={petrol === true}\n              onChange={(value) => setPetrol(true)}\n            />\n            <Form.Check\n              inline\n              label=\"No\"\n              name=\"petrol\"\n              type=\"radio\"\n              id=\"petrol-check-no\"\n              checked={petrol === false}\n              onChange={(value) => setPetrol(false)}\n            />\n            <Form.Check\n              inline\n              label=\"Don't know\"\n              name=\"petrol\"\n              type=\"radio\"\n              id=\"petrol-check-dontknow\"\n              checked={petrol === undefined}\n              onChange={(value) => setPetrol(undefined)}\n            />\n          </Col>\n        </Form.Group>\n\n        <Form.Group as={Row} className=\"mb-3\" controlId=\"formDiesel\">\n          <Form.Label column sm=\"4\">\n            Is there Diesel?\n          </Form.Label>\n          <Col sm=\"8\">\n            <Form.Check\n              inline\n              label=\"Yes\"\n              name=\"diesel\"\n              type=\"radio\"\n              id=\"diesel-check-yes\"\n              checked={diesel === true}\n              onChange={(value) => setDiesel(true)}\n            />\n            <Form.Check\n              inline\n              label=\"No\"\n              name=\"diesel\"\n              type=\"radio\"\n              id=\"diesel-check-no\"\n              checked={diesel === false}\n              onChange={(value) => setDiesel(false)}\n            />\n            <Form.Check\n              inline\n              label=\"Don't know\"\n              name=\"diesel\"\n              type=\"radio\"\n              id=\"diesel-check-dontknow\"\n              checked={diesel === undefined}\n              onChange={(value) => setDiesel(undefined)}\n            />\n          </Col>\n        </Form.Group>\n\n        <Form.Group as={Row} className=\"mb-3\" controlId=\"formQueue\">\n          <Form.Label column sm=\"4\">\n            How long is the queue in minutes, your guess?\n          </Form.Label>\n          <Col sm=\"8\">\n            <Form.Range\n              min=\"-5\"\n              max=\"120\"\n              value={queue}\n              step={5}\n              onChange={(event) => {\n                setQueue(event.target.value);\n              }}\n            />\n            {queue >= 0 ? `${queue} minute(s)` : \"No idea\"}\n          </Col>\n        </Form.Group>\n        <Button variant=\"primary\" type=\"submit\">\n          Submit\n        </Button>\n      </Form>\n    </div>\n  );\n};\n\nexport { UpdateForm };\n","import axios from \"axios\";\nconst STATIONS_URL = \"stations.json\";\nconst SAVE_URL = process.env.REACT_APP_SAVE_API_URL;\nconst loadStations = (callback, errorCallback) => {\n  const url = `${STATIONS_URL}?t=${new Date().getTime()}`;\n  axios.get(url).then(callback).catch(errorCallback);\n};\n\nconst saveStation = (data, callback) => {\n  axios.post(SAVE_URL, data).then(callback);\n};\n\nexport { loadStations, saveStation };\n","import { Row, Col, Badge, Button } from \"react-bootstrap\";\nimport { useState } from \"react\";\nimport { haversineDistance } from \"../lib/geo\";\nimport { UpdateForm } from \"./UpdateForm\";\n\n/**\n * -1: confident there is no fuel\n * 0: not sure\n * 1: confident there is fuel\n * @param {*} mRecent\n * @param {*} mAll\n * @returns\n */\nconst getFuelConfidenceScore = (mRecent, mAll) => {\n  const mRecent_total = mRecent.yes + mRecent.no;\n\n  const mAll_total = mAll.yes + mAll.no;\n  const mRecent_strength = 1 - 1 / Math.pow(3, mRecent_total);\n  const mAll_strength = 1 - 1 / Math.pow(3, mAll_total);\n\n  if (mAll_total === 0) return 0;\n  return (\n    0.3 *\n      mRecent_strength *\n      (mRecent_total > 0 ? (mRecent.yes - mRecent.no) / mRecent_total : 0) +\n    0.7 *\n      mAll_strength *\n      (mAll_total > 0 ? (mAll.yes - mAll.no) / mAll_total : 0)\n  );\n};\n\nconst getLabelForConfidence = (confidence) => {\n  const label = confidence < 0 ? \"no\" : \"yes\";\n  if (Math.abs(confidence) < 0.1) return [\"Don't know\", \"secondary\"];\n  if (Math.abs(confidence) < 0.4) return [`Not sure`, \"warning\"];\n  if (Math.abs(confidence) < 0.7)\n    return [`Probably ${label}`, confidence < 0 ? \"danger\" : \"success\"];\n  return [label, confidence < 0 ? \"danger\" : \"success\"];\n};\n\nconst StationRow = (props) => {\n  const { id, coords, name, last_update, phone, address, stats } =\n    props.station;\n  const [isFormVisible, setFormVisible] = useState(false);\n  const distance = haversineDistance(coords, props.userLocation);\n  const myGmapsLocation = [props.userLocation[1], props.userLocation[0]];\n  const mapUrl = `https://www.google.com/maps/dir/${myGmapsLocation}/${coords[1]},${coords[0]}`;\n  // console.log(stats);\n  const dieselConfidence = getFuelConfidenceScore(\n    stats[\"1800\"][\"diesel\"],\n    stats[\"7200\"][\"diesel\"]\n  );\n  const [dieselLabel, dieselVariant] = getLabelForConfidence(dieselConfidence);\n  const petrolConfidence = getFuelConfidenceScore(\n    stats[\"1800\"][\"petrol\"],\n    stats[\"7200\"][\"petrol\"]\n  );\n  const [petrolLabel, petrolVariant] = getLabelForConfidence(petrolConfidence);\n\n  /*\n  Possible states:\n  - yes\n  - no\n  - maybe\n  - information outdated\n  \n  */\n  // console.log(last_update);\n  const lastUpdate = Math.round(\n    (new Date().getTime() / 1000 - last_update) / 60\n  );\n  return (\n    <div className=\"station\">\n      <Row>\n        <Col>\n          <div className=\"stationName\">{name || address || \"unnamed\"}</div>\n          <small>\n            {Math.ceil(distance * 100) / 100} miles away. (\n            <a href={mapUrl}>Directions</a>)\n          </small>\n        </Col>\n        <Col>\n          <div className=\"stationInfo\">\n            Diesel:\n            <Badge bg={dieselVariant}>{dieselLabel}</Badge>\n            <br />\n            Petrol:\n            <Badge bg={petrolVariant}>{petrolLabel}</Badge>\n            <br />\n            <div className=\"lastUpdate\">last update {lastUpdate}m ago</div>\n          </div>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          {phone && (\n            <Button size=\"sm\" variant=\"info\" href={`tel://${phone}`}>\n              Call them: {phone}\n            </Button>\n          )}\n        </Col>\n        <Col>\n          <Button\n            size=\"sm\"\n            variant=\"warning\"\n            onClick={(e) => setFormVisible(!isFormVisible)}\n          >\n            {isFormVisible ? \"Hide\" : \"Send Update\"}\n          </Button>\n        </Col>\n      </Row>\n      {isFormVisible && <UpdateForm stationId={id} />}\n    </div>\n  );\n};\n\nexport { StationRow };\n","import { StationRow } from \"./StationRow\";\n\nconst StationList = (props) => {\n  const { userLocation, stations, lastUpdate } = props;\n  const updateMinutesAgo = Math.ceil(\n    (new Date().getTime() / 1000 - lastUpdate) / 60\n  );\n  const stationElemennts = stations.map((station) => (\n    <StationRow\n      key={station.id}\n      station={station}\n      userLocation={userLocation}\n    />\n  ));\n  return (\n    <div className=\"stationList\">\n      <div>Last update: {updateMinutesAgo} minutes ago</div>\n      {stationElemennts}\n    </div>\n  );\n};\n\nexport { StationList };\n","import { useState, useEffect } from \"react\";\nimport { loadStations } from \"./lib/data\";\nimport { usePosition, findNearestStations } from \"./lib/geo\";\nimport { Container, Row, Col, Alert } from \"react-bootstrap\";\nimport { StationList } from \"./components/StationList\";\n\nconst RADIUS = 8;\n\nfunction App() {\n  const [stations, setStations] = useState(null);\n  const [nearestStations, setNearestStations] = useState(null);\n  const [loadError, setLoadError] = useState(null);\n  const { latitude, longitude, error } = usePosition();\n  useEffect(() => {\n    loadStations((result) => setStations(result.data), setLoadError);\n  }, []);\n\n  useEffect(() => {\n    setNearestStations(\n      stations && latitude && longitude\n        ? {\n            lastUpdate: stations.last_update,\n            stationData: findNearestStations(\n              [longitude, latitude],\n              stations.station_data,\n              RADIUS\n            ),\n          }\n        : null\n    );\n  }, [stations, latitude, longitude]);\n\n  var content = null;\n  if (!stations) {\n    if (loadError) {\n      content = <Alert>Coulnd't load stations. Error happened.</Alert>;\n    } else content = <Alert>Loading stations...</Alert>;\n  }\n  if (!latitude) {\n    if (error) {\n      content = <Alert>Coulnd't get your location.</Alert>;\n    }\n    content = <Alert>Getting your location</Alert>;\n  }\n\n  if (!content && nearestStations) {\n    content = (\n      <StationList\n        userLocation={[longitude, latitude]}\n        stations={nearestStations.stationData}\n        lastUpdate={stations.last_update}\n      />\n    );\n  }\n  return (\n    <Container>\n      <Row>\n        <Col>\n          <h1>FuelFinder.uk</h1>\n          <p>\n            This is a free,{\" \"}\n            <a href=\"https://github.com/sztanko/fuelfinder\">open source</a>{\" \"}\n            crowdsourced project. Please contribute! Any questions,{\" \"}\n            <a href=\"mailto:sztanko@gmail.com\">email me</a>.\n          </p>\n        </Col>\n      </Row>\n      <Row>\n        <Col>\n          <h3>Nearest Stations</h3>\n          {content}\n        </Col>\n      </Row>\n    </Container>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n// import reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n"],"sourceRoot":""}