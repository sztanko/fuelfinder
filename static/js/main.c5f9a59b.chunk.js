(this.webpackJsonpfuelfinder=this.webpackJsonpfuelfinder||[]).push([[0],{40:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),s=n(11),i=n.n(s),o=(n(40),n(6)),r=n(19),l=n.n(r),j=n(2),u=function(e,t){var n=Object(o.a)(e,2),a=n[0],c=n[1],s=Object(o.a)(t,2),i=s[0],r=s[1],l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],j=function(e){return Math.PI/180*e},u=function(e,t){return Math.PI/180*(e-t)},d=u(r,c),b=u(i,a);c=j(c),r=j(r);var h=Math.pow(Math.sin(d/2),2)+Math.pow(Math.sin(b/2),2)*Math.cos(c)*Math.cos(r),O=2*Math.asin(Math.sqrt(h)),m=6371*O;return l&&(m/=1.60934),m},d=function(e,t,n){return t.filter((function(t){return u(e,t.coords)<n})).sort((function(t,n){return u(e,t.coords)-u(e,n.coords)}))},b=n(69),h=n(68),O=n(65),m=n(32),x=n(67),f=n(66),p=n(70),v=n(1),g=function(e){var t=e.stationId,n=Object(a.useState)(void 0),c=Object(o.a)(n,2),s=c[0],i=c[1],r=Object(a.useState)(void 0),j=Object(o.a)(r,2),u=j[0],d=j[1],h=Object(a.useState)(-5),x=Object(o.a)(h,2),g=x[0],k=x[1],w=Object(a.useState)(null),y=Object(o.a)(w,2),M=y[0],C=y[1];return M?Object(v.jsx)("div",{className:"submitForm",children:Object(v.jsx)(O.a,{children:Object(v.jsx)(m.a,{children:Object(v.jsx)(b.a,{variant:"success",children:"Thank you for submitting this information. It will appear on the website within the next 5 minutes."})})})}):Object(v.jsx)("div",{className:"submitForm",children:Object(v.jsxs)(p.a,{onSubmit:function(e){e.preventDefault(),console.log(e),function(e,t){l.a.post("https://ekale7ux51.execute-api.eu-west-2.amazonaws.com/Production",e).then(t)}({id:t,petrol:s,diesel:u,queue:g},(function(){C(!0)}))},children:[Object(v.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formPetrol",children:[Object(v.jsx)(p.a.Label,{column:!0,sm:"4",children:"Is there Petrol?"}),Object(v.jsxs)(m.a,{sm:"8",children:[Object(v.jsx)(p.a.Check,{inline:!0,label:"Yes",name:"petrol",type:"radio",id:"petrol-check-yes",checked:!0===s,onChange:function(e){return i(!0)}}),Object(v.jsx)(p.a.Check,{inline:!0,label:"No",name:"petrol",type:"radio",id:"petrol-check-no",checked:!1===s,onChange:function(e){return i(!1)}}),Object(v.jsx)(p.a.Check,{inline:!0,label:"Don't know",name:"petrol",type:"radio",id:"petrol-check-dontknow",checked:void 0===s,onChange:function(e){return i(void 0)}})]})]}),Object(v.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formDiesel",children:[Object(v.jsx)(p.a.Label,{column:!0,sm:"4",children:"Is there Diesel?"}),Object(v.jsxs)(m.a,{sm:"8",children:[Object(v.jsx)(p.a.Check,{inline:!0,label:"Yes",name:"diesel",type:"radio",id:"diesel-check-yes",checked:!0===u,onChange:function(e){return d(!0)}}),Object(v.jsx)(p.a.Check,{inline:!0,label:"No",name:"diesel",type:"radio",id:"diesel-check-no",checked:!1===u,onChange:function(e){return d(!1)}}),Object(v.jsx)(p.a.Check,{inline:!0,label:"Don't know",name:"diesel",type:"radio",id:"diesel-check-dontknow",checked:void 0===u,onChange:function(e){return d(void 0)}})]})]}),Object(v.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formQueue",children:[Object(v.jsx)(p.a.Label,{column:!0,sm:"4",children:"How long is the queue in minutes, your guess?"}),Object(v.jsxs)(m.a,{sm:"8",children:[Object(v.jsx)(p.a.Range,{min:"-5",max:"120",value:g,step:5,onChange:function(e){k(e.target.value)}}),g>=0?"".concat(g," minute(s)"):"No idea"]})]}),Object(v.jsx)(f.a,{variant:"primary",type:"submit",children:"Submit"})]})})},k=function(e,t){var n=e.yes+e.no,a=t.yes+t.no,c=1-1/Math.pow(3,n),s=1-1/Math.pow(3,a);return 0===a?0:.3*c*(n>0?(e.yes-e.no)/n:0)+.7*s*(a>0?(t.yes-t.no)/a:0)},w=function(e){var t=e<0?"no":"yes";return Math.abs(e)<.1?["Don't know","secondary"]:Math.abs(e)<.4?["Not sure","warning"]:Math.abs(e)<.7?["Probably ".concat(t),e<0?"danger":"success"]:[t,e<0?"danger":"success"]},y=function(e){var t=e.station,n=t.id,c=t.coords,s=t.name,i=t.last_update,r=t.phone,l=t.address,j=t.stats,d=Object(a.useState)(!1),b=Object(o.a)(d,2),h=b[0],p=b[1],y=u(c,e.userLocation),M=[e.userLocation[1],e.userLocation[0]],C="https://www.google.com/maps/dir/".concat(M,"/").concat(c[1],",").concat(c[0]),S=k(j[1800].diesel,j[7200].diesel),N=w(S),I=Object(o.a)(N,2),L=I[0],D=I[1],P=k(j[1800].petrol,j[7200].petrol),E=w(P),G=Object(o.a)(E,2),U=G[0],F=G[1],_=Math.round(((new Date).getTime()/1e3-i)/60);return Object(v.jsxs)("div",{className:"station",children:[Object(v.jsxs)(O.a,{children:[Object(v.jsxs)(m.a,{children:[s||l||"unnamed",Object(v.jsx)("br",{}),Object(v.jsx)("small",{children:Object(v.jsxs)("a",{href:C,children:[Math.ceil(100*y)/100," miles away"]})})]}),Object(v.jsx)(m.a,{children:Object(v.jsxs)("div",{className:"stationInfo",children:["Diesel:",Object(v.jsx)(x.a,{bg:D,children:L}),Object(v.jsx)("br",{}),"Petrol:",Object(v.jsx)(x.a,{bg:F,children:U}),Object(v.jsx)("br",{}),Object(v.jsxs)("div",{className:"lastUpdate",children:["last update ",_,"m ago"]})]})})]}),Object(v.jsxs)(O.a,{children:[Object(v.jsx)(m.a,{children:r&&Object(v.jsxs)(f.a,{size:"sm",variant:"info",href:"tel://".concat(r),children:["Call them: ",r]})}),Object(v.jsx)(m.a,{children:Object(v.jsx)(f.a,{size:"sm",variant:"warning",onClick:function(e){return p(!h)},children:h?"Hide":"Send Update"})})]}),h&&Object(v.jsx)(g,{stationId:n})]})},M=function(e){var t=e.userLocation,n=e.stations,a=e.lastUpdate,c=Math.ceil(((new Date).getTime()/1e3-a)/60),s=n.map((function(e){return Object(v.jsx)(y,{station:e,userLocation:t},e.id)}));return Object(v.jsxs)("div",{className:"stationList",children:[Object(v.jsxs)("div",{children:["Last update: ",c," minutes ago"]}),s]})};var C=function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),i=Object(o.a)(s,2),r=i[0],u=i[1],x=Object(a.useState)(null),f=Object(o.a)(x,2),p=f[0],g=f[1],k=function(){var e=Object(a.useState)({}),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),i=Object(o.a)(s,2),r=i[0],l=i[1],u=function(e){var t=e.coords;c({latitude:t.latitude,longitude:t.longitude})},d=function(e){l(e.message)};return Object(a.useEffect)((function(){var e=navigator.geolocation;if(e){var t=e.watchPosition(u,d);return function(){return e.clearWatch(t)}}l("Geolocation is not supported")}),[]),Object(j.a)(Object(j.a)({},n),{},{error:r})}(),w=k.latitude,y=k.longitude,C=k.error;Object(a.useEffect)((function(){var e,t;e=function(e){return c(e.data)},t=g,l.a.get("stations.json").then(e).catch(t)}),[]),Object(a.useEffect)((function(){u(n&&w&&y?{lastUpdate:n.last_update,stationData:d([y,w],n.station_data,8)}:null)}),[n,w,y]);var S=null;return n||(S=p?Object(v.jsx)(b.a,{children:"Coulnd't load stations. Error happened."}):Object(v.jsx)(b.a,{children:"Loading stations..."})),w||(C&&(S=Object(v.jsx)(b.a,{children:"Coulnd't get your location."})),S=Object(v.jsx)(b.a,{children:"Getting your location"})),!S&&r&&(S=Object(v.jsx)(M,{userLocation:[y,w],stations:r.stationData,lastUpdate:n.last_update})),Object(v.jsxs)(h.a,{children:[Object(v.jsx)(O.a,{children:Object(v.jsx)(m.a,{children:Object(v.jsx)("h1",{children:"FuelFinder.uk"})})}),Object(v.jsx)(O.a,{children:Object(v.jsxs)(m.a,{children:[Object(v.jsx)("h2",{children:"Nearest Stations"}),S]})})]})};i.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(C,{})}),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.c5f9a59b.chunk.js.map