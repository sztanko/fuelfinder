(this.webpackJsonpfuelfinder=this.webpackJsonpfuelfinder||[]).push([[0],{40:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),s=n(11),o=n.n(s),i=(n(40),n(6)),r=n(19),l=n.n(r),d=n(2),j=function(e,t){var n=Object(i.a)(e,2),a=n[0],c=n[1],s=Object(i.a)(t,2),o=s[0],r=s[1],l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],d=function(e){return Math.PI/180*e},j=function(e,t){return Math.PI/180*(e-t)},u=j(r,c),b=j(o,a);c=d(c),r=d(r);var h=Math.pow(Math.sin(u/2),2)+Math.pow(Math.sin(b/2),2)*Math.cos(c)*Math.cos(r),O=2*Math.asin(Math.sqrt(h)),m=6371*O;return l&&(m/=1.60934),m},u=function(e,t,n){return t.filter((function(t){return j(e,t.coords)<n})).sort((function(t,n){return j(e,t.coords)-j(e,n.coords)}))},b=n(69),h=n(68),O=n(65),m=n(32),x=n(67),f=n(66),p=n(70),g=n(1),v=function(e){var t=e.stationId,n=e.address,c=Object(a.useState)(void 0),s=Object(i.a)(c,2),o=s[0],r=s[1],d=Object(a.useState)(void 0),j=Object(i.a)(d,2),u=j[0],h=j[1],x=Object(a.useState)(n||""),v=Object(i.a)(x,2),k=v[0],w=v[1],y=Object(a.useState)(-5),C=Object(i.a)(y,2),M=C[0],S=C[1],N=Object(a.useState)(null),D=Object(i.a)(N,2),I=D[0],L=D[1];return I?Object(g.jsx)("div",{className:"submitForm",children:Object(g.jsx)(O.a,{children:Object(g.jsx)(m.a,{children:Object(g.jsx)(b.a,{variant:"success",children:"Thank you for submitting this information. It will appear on the website within the next 10-15 minutes."})})})}):Object(g.jsx)("div",{className:"submitForm",children:Object(g.jsxs)(p.a,{onSubmit:function(e){e.preventDefault(),function(e,t){l.a.post("https://ekale7ux51.execute-api.eu-west-2.amazonaws.com/Production",e).then(t)}({id:t,petrol:o,diesel:u,queue:M,addr:k},(function(){L(!0)}))},children:[Object(g.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formPetrol",children:[Object(g.jsx)(p.a.Label,{column:!0,sm:"4",children:"Is there Petrol?"}),Object(g.jsxs)(m.a,{sm:"8",children:[Object(g.jsx)(p.a.Check,{inline:!0,label:"Yes",name:"petrol",type:"radio",id:"petrol-check-yes",checked:!0===o,onChange:function(e){return r(!0)}}),Object(g.jsx)(p.a.Check,{inline:!0,label:"No",name:"petrol",type:"radio",id:"petrol-check-no",checked:!1===o,onChange:function(e){return r(!1)}}),Object(g.jsx)(p.a.Check,{inline:!0,label:"Don't know",name:"petrol",type:"radio",id:"petrol-check-dontknow",checked:void 0===o,onChange:function(e){return r(void 0)}})]})]}),Object(g.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formDiesel",children:[Object(g.jsx)(p.a.Label,{column:!0,sm:"4",children:"Is there Diesel?"}),Object(g.jsxs)(m.a,{sm:"8",children:[Object(g.jsx)(p.a.Check,{inline:!0,label:"Yes",name:"diesel",type:"radio",id:"diesel-check-yes",checked:!0===u,onChange:function(e){return h(!0)}}),Object(g.jsx)(p.a.Check,{inline:!0,label:"No",name:"diesel",type:"radio",id:"diesel-check-no",checked:!1===u,onChange:function(e){return h(!1)}}),Object(g.jsx)(p.a.Check,{inline:!0,label:"Don't know",name:"diesel",type:"radio",id:"diesel-check-dontknow",checked:void 0===u,onChange:function(e){return h(void 0)}})]})]}),Object(g.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formQueue",children:[Object(g.jsx)(p.a.Label,{column:!0,sm:"4",children:"How long is the queue in minutes, your guess?"}),Object(g.jsxs)(m.a,{sm:"8",children:[Object(g.jsx)(p.a.Range,{min:"-5",max:"120",value:M,step:5,onChange:function(e){S(e.target.value)}}),M>=0?"".concat(M," minute(s)"):"No idea"]})]}),Object(g.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formAddr",children:[Object(g.jsx)(p.a.Label,{column:!0,sm:"5",children:"Street name, neighbourhood, correct if empty or wrong:"}),Object(g.jsx)(m.a,{sm:"7",children:Object(g.jsx)(p.a.Control,{type:"text",value:k,onChange:function(e){w(e.target.value)}})})]}),Object(g.jsx)(f.a,{variant:"primary",type:"submit",children:"Submit"})]})})},k=10800..toString(),w=1800..toString(),y=function(e,t){var n=e.yes+e.no,a=t.yes+t.no,c=1-1/Math.pow(3,n),s=1-1/Math.pow(3,a);return 0===a?0:.3*c*(n>0?(e.yes-e.no)/n:0)+.7*s*(a>0?(t.yes-t.no)/a:0)},C=function(e){var t=e<0?"no":"yes";return Math.abs(e)<.1?["Don't know","secondary"]:Math.abs(e)<.4?["Not sure","warning"]:Math.abs(e)<.7?["Probably ".concat(t),e<0?"danger":"success"]:[t,e<0?"danger":"success"]},M=function(e){var t=e.station,n=t.id,c=t.coords,s=t.name,o=t.last_update,r=t.phone,l=t.addr,d=t.stats,u=Object(a.useState)(!1),b=Object(i.a)(u,2),h=b[0],p=b[1],M=j(c,e.userLocation),S=[e.userLocation[1],e.userLocation[0]],N="https://www.google.com/maps/dir/".concat(S,"/").concat(c[1],",").concat(c[0]),D=y(d[w].diesel,d[k].diesel),I=C(D),L=Object(i.a)(I,2),P=L[0],G=L[1],z=y(d[w].petrol,d[k].petrol),E=C(z),T=Object(i.a)(E,2),U=T[0],q=T[1],F=Math.round(((new Date).getTime()/1e3-o)/60);return Object(g.jsxs)("div",{className:"station",children:[Object(g.jsxs)(O.a,{children:[Object(g.jsxs)(m.a,{children:[Object(g.jsx)("div",{className:"stationName",children:s||l||"unnamed"}),l&&Object(g.jsx)("p",{children:l}),Object(g.jsxs)("small",{children:[Math.ceil(100*M)/100," miles away. (",Object(g.jsx)("a",{href:N,children:"Directions"}),")"]})]}),Object(g.jsx)(m.a,{children:Object(g.jsxs)("div",{className:"stationInfo",children:["Diesel:",Object(g.jsx)(x.a,{bg:G,children:P}),Object(g.jsx)("br",{}),"Petrol:",Object(g.jsx)(x.a,{bg:q,children:U}),Object(g.jsx)("br",{}),Object(g.jsx)("div",{className:"lastUpdate",children:F<300?"last update ".concat(F,"m ago"):"too long ago"})]})})]}),Object(g.jsxs)(O.a,{children:[Object(g.jsx)(m.a,{children:r&&Object(g.jsxs)(f.a,{size:"sm",variant:"info",href:"tel://".concat(r),children:["Call them: ",r]})}),Object(g.jsx)(m.a,{children:Object(g.jsx)(f.a,{size:"sm",variant:"warning",onClick:function(e){return p(!h)},children:h?"Hide":"Send Update"})})]}),h&&Object(g.jsx)(v,{stationId:n,address:""})]})},S=function(e){var t=e.userLocation,n=e.stations,a=e.lastUpdate,c=Math.ceil(((new Date).getTime()/1e3-a)/60),s=n.map((function(e){return Object(g.jsx)(M,{station:e,userLocation:t},e.id)}));return Object(g.jsxs)("div",{className:"stationList",children:[Object(g.jsxs)("div",{children:["Last update: ",c," minutes ago"]}),s]})};var N=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),o=Object(i.a)(s,2),r=o[0],j=o[1],x=Object(a.useState)(null),f=Object(i.a)(x,2),p=f[0],v=f[1],k=function(){var e=Object(a.useState)({}),t=Object(i.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),o=Object(i.a)(s,2),r=o[0],l=o[1],j=function(e){var t=e.coords;c({latitude:t.latitude,longitude:t.longitude})},u=function(e){l(e.message)};return Object(a.useEffect)((function(){var e=navigator.geolocation;if(e){var t=e.watchPosition(j,u);return function(){return e.clearWatch(t)}}l("Geolocation is not supported")}),[]),Object(d.a)(Object(d.a)({},n),{},{error:r})}(),w=k.latitude,y=k.longitude,C=k.error;Object(a.useEffect)((function(){!function(e,t){var n="".concat("stations.json","?t=").concat((new Date).getTime());l.a.get(n).then(e).catch(t)}((function(e){return c(e.data)}),v)}),[]),Object(a.useEffect)((function(){j(n&&w&&y?{lastUpdate:n.last_update,stationData:u([y,w],n.station_data,8)}:null)}),[n,w,y]);var M=null;return n||(M=p?Object(g.jsx)(b.a,{children:"Coulnd't load stations. Error happened."}):Object(g.jsx)(b.a,{children:"Loading stations..."})),w||(C&&(M=Object(g.jsx)(b.a,{children:"Coulnd't get your location."})),M=Object(g.jsx)(b.a,{children:"Getting your location. Please make sure you have location sharing enabled. We are not storing it anywhere."})),!M&&r&&(M=Object(g.jsx)(S,{userLocation:[y,w],stations:r.stationData,lastUpdate:n.last_update})),Object(g.jsxs)(h.a,{children:[Object(g.jsx)(O.a,{children:Object(g.jsxs)(m.a,{children:[Object(g.jsx)("h1",{children:"FuelFinder.uk"}),Object(g.jsxs)("p",{children:["This is a free,"," ",Object(g.jsx)("a",{href:"https://github.com/sztanko/fuelfinder",children:"open source"})," ","crowdsourced project. Please contribute! Any questions,"," ",Object(g.jsx)("a",{href:"mailto:sztanko@gmail.com",children:"email me"}),"."]})]})}),Object(g.jsx)(O.a,{children:Object(g.jsxs)(m.a,{children:[Object(g.jsx)("h3",{children:"Nearest Stations"}),M]})})]})};o.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(N,{})}),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.0a05cf9c.chunk.js.map