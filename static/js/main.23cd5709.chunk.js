(this.webpackJsonpfuelfinder=this.webpackJsonpfuelfinder||[]).push([[0],{40:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),s=n(11),i=n.n(s),o=(n(40),n(6)),r=n(19),l=n.n(r),j=n(2),d=function(e,t){var n=Object(o.a)(e,2),a=n[0],c=n[1],s=Object(o.a)(t,2),i=s[0],r=s[1],l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],j=function(e){return Math.PI/180*e},d=function(e,t){return Math.PI/180*(e-t)},u=d(r,c),h=d(i,a);c=j(c),r=j(r);var b=Math.pow(Math.sin(u/2),2)+Math.pow(Math.sin(h/2),2)*Math.cos(c)*Math.cos(r),O=2*Math.asin(Math.sqrt(b)),m=6371*O;return l&&(m/=1.60934),m},u=function(e,t,n){return t.filter((function(t){return d(e,t.coords)<n})).sort((function(t,n){return d(e,t.coords)-d(e,n.coords)}))},h=n(69),b=n(68),O=n(65),m=n(32),x=n(67),f=n(66),p=n(70),g=n(1),v=function(e){var t=e.stationId,n=Object(a.useState)(void 0),c=Object(o.a)(n,2),s=c[0],i=c[1],r=Object(a.useState)(void 0),j=Object(o.a)(r,2),d=j[0],u=j[1],b=Object(a.useState)(-5),x=Object(o.a)(b,2),v=x[0],k=x[1],w=Object(a.useState)(null),y=Object(o.a)(w,2),M=y[0],C=y[1];return M?Object(g.jsx)("div",{className:"submitForm",children:Object(g.jsx)(O.a,{children:Object(g.jsx)(m.a,{children:Object(g.jsx)(h.a,{variant:"success",children:"Thank you for submitting this information. It will appear on the website within the next 10-15 minutes."})})})}):Object(g.jsx)("div",{className:"submitForm",children:Object(g.jsxs)(p.a,{onSubmit:function(e){e.preventDefault(),console.log(e),function(e,t){l.a.post("https://ekale7ux51.execute-api.eu-west-2.amazonaws.com/Production",e).then(t)}({id:t,petrol:s,diesel:d,queue:v},(function(){C(!0)}))},children:[Object(g.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formPetrol",children:[Object(g.jsx)(p.a.Label,{column:!0,sm:"4",children:"Is there Petrol?"}),Object(g.jsxs)(m.a,{sm:"8",children:[Object(g.jsx)(p.a.Check,{inline:!0,label:"Yes",name:"petrol",type:"radio",id:"petrol-check-yes",checked:!0===s,onChange:function(e){return i(!0)}}),Object(g.jsx)(p.a.Check,{inline:!0,label:"No",name:"petrol",type:"radio",id:"petrol-check-no",checked:!1===s,onChange:function(e){return i(!1)}}),Object(g.jsx)(p.a.Check,{inline:!0,label:"Don't know",name:"petrol",type:"radio",id:"petrol-check-dontknow",checked:void 0===s,onChange:function(e){return i(void 0)}})]})]}),Object(g.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formDiesel",children:[Object(g.jsx)(p.a.Label,{column:!0,sm:"4",children:"Is there Diesel?"}),Object(g.jsxs)(m.a,{sm:"8",children:[Object(g.jsx)(p.a.Check,{inline:!0,label:"Yes",name:"diesel",type:"radio",id:"diesel-check-yes",checked:!0===d,onChange:function(e){return u(!0)}}),Object(g.jsx)(p.a.Check,{inline:!0,label:"No",name:"diesel",type:"radio",id:"diesel-check-no",checked:!1===d,onChange:function(e){return u(!1)}}),Object(g.jsx)(p.a.Check,{inline:!0,label:"Don't know",name:"diesel",type:"radio",id:"diesel-check-dontknow",checked:void 0===d,onChange:function(e){return u(void 0)}})]})]}),Object(g.jsxs)(p.a.Group,{as:O.a,className:"mb-3",controlId:"formQueue",children:[Object(g.jsx)(p.a.Label,{column:!0,sm:"4",children:"How long is the queue in minutes, your guess?"}),Object(g.jsxs)(m.a,{sm:"8",children:[Object(g.jsx)(p.a.Range,{min:"-5",max:"120",value:v,step:5,onChange:function(e){k(e.target.value)}}),v>=0?"".concat(v," minute(s)"):"No idea"]})]}),Object(g.jsx)(f.a,{variant:"primary",type:"submit",children:"Submit"})]})})},k=10800..toString(),w=1800..toString(),y=function(e,t){var n=e.yes+e.no,a=t.yes+t.no,c=1-1/Math.pow(3,n),s=1-1/Math.pow(3,a);return 0===a?0:.3*c*(n>0?(e.yes-e.no)/n:0)+.7*s*(a>0?(t.yes-t.no)/a:0)},M=function(e){var t=e<0?"no":"yes";return Math.abs(e)<.1?["Don't know","secondary"]:Math.abs(e)<.4?["Not sure","warning"]:Math.abs(e)<.7?["Probably ".concat(t),e<0?"danger":"success"]:[t,e<0?"danger":"success"]},C=function(e){var t=e.station,n=t.id,c=t.coords,s=t.name,i=t.last_update,r=t.phone,l=t.addr,j=t.stats,u=Object(a.useState)(!1),h=Object(o.a)(u,2),b=h[0],p=h[1],C=d(c,e.userLocation),S=[e.userLocation[1],e.userLocation[0]],N="https://www.google.com/maps/dir/".concat(S,"/").concat(c[1],",").concat(c[0]),D=y(j[w].diesel,j[k].diesel),I=M(D),L=Object(o.a)(I,2),P=L[0],z=L[1],E=y(j[w].petrol,j[k].petrol),G=M(E),T=Object(o.a)(G,2),U=T[0],q=T[1],F=Math.round(((new Date).getTime()/1e3-i)/60);return Object(g.jsxs)("div",{className:"station",children:[Object(g.jsxs)(O.a,{children:[Object(g.jsxs)(m.a,{children:[Object(g.jsx)("div",{className:"stationName",children:s||l||"unnamed"}),l&&Object(g.jsx)("p",{children:l}),Object(g.jsxs)("small",{children:[Math.ceil(100*C)/100," miles away. (",Object(g.jsx)("a",{href:N,children:"Directions"}),")"]})]}),Object(g.jsx)(m.a,{children:Object(g.jsxs)("div",{className:"stationInfo",children:["Diesel:",Object(g.jsx)(x.a,{bg:z,children:P}),Object(g.jsx)("br",{}),"Petrol:",Object(g.jsx)(x.a,{bg:q,children:U}),Object(g.jsx)("br",{}),Object(g.jsxs)("div",{className:"lastUpdate",children:["last update ",F,"m ago"]})]})})]}),Object(g.jsxs)(O.a,{children:[Object(g.jsx)(m.a,{children:r&&Object(g.jsxs)(f.a,{size:"sm",variant:"info",href:"tel://".concat(r),children:["Call them: ",r]})}),Object(g.jsx)(m.a,{children:Object(g.jsx)(f.a,{size:"sm",variant:"warning",onClick:function(e){return p(!b)},children:b?"Hide":"Send Update"})})]}),b&&Object(g.jsx)(v,{stationId:n,address:""})]})},S=function(e){var t=e.userLocation,n=e.stations,a=e.lastUpdate,c=Math.ceil(((new Date).getTime()/1e3-a)/60),s=n.map((function(e){return Object(g.jsx)(C,{station:e,userLocation:t},e.id)}));return Object(g.jsxs)("div",{className:"stationList",children:[Object(g.jsxs)("div",{children:["Last update: ",c," minutes ago"]}),s]})};var N=function(){var e=Object(a.useState)(null),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),i=Object(o.a)(s,2),r=i[0],d=i[1],x=Object(a.useState)(null),f=Object(o.a)(x,2),p=f[0],v=f[1],k=function(){var e=Object(a.useState)({}),t=Object(o.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)(null),i=Object(o.a)(s,2),r=i[0],l=i[1],d=function(e){var t=e.coords;c({latitude:t.latitude,longitude:t.longitude})},u=function(e){l(e.message)};return Object(a.useEffect)((function(){var e=navigator.geolocation;if(e){var t=e.watchPosition(d,u);return function(){return e.clearWatch(t)}}l("Geolocation is not supported")}),[]),Object(j.a)(Object(j.a)({},n),{},{error:r})}(),w=k.latitude,y=k.longitude,M=k.error;Object(a.useEffect)((function(){!function(e,t){var n="".concat("stations.json","?t=").concat((new Date).getTime());l.a.get(n).then(e).catch(t)}((function(e){return c(e.data)}),v)}),[]),Object(a.useEffect)((function(){d(n&&w&&y?{lastUpdate:n.last_update,stationData:u([y,w],n.station_data,8)}:null)}),[n,w,y]);var C=null;return n||(C=p?Object(g.jsx)(h.a,{children:"Coulnd't load stations. Error happened."}):Object(g.jsx)(h.a,{children:"Loading stations..."})),w||(M&&(C=Object(g.jsx)(h.a,{children:"Coulnd't get your location."})),C=Object(g.jsx)(h.a,{children:"Getting your location. Please make sure you have location sharing enabled."})),!C&&r&&(C=Object(g.jsx)(S,{userLocation:[y,w],stations:r.stationData,lastUpdate:n.last_update})),Object(g.jsxs)(b.a,{children:[Object(g.jsx)(O.a,{children:Object(g.jsxs)(m.a,{children:[Object(g.jsx)("h1",{children:"FuelFinder.uk"}),Object(g.jsxs)("p",{children:["This is a free,"," ",Object(g.jsx)("a",{href:"https://github.com/sztanko/fuelfinder",children:"open source"})," ","crowdsourced project. Please contribute! Any questions,"," ",Object(g.jsx)("a",{href:"mailto:sztanko@gmail.com",children:"email me"}),"."]})]})}),Object(g.jsx)(O.a,{children:Object(g.jsxs)(m.a,{children:[Object(g.jsx)("h3",{children:"Nearest Stations"}),C]})})]})};i.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(N,{})}),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.23cd5709.chunk.js.map